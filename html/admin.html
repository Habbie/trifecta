<!doctype html>
<html>

<head>
  <meta charset="utf-8">

  <link rel='stylesheet' href='style.css'>
  <script defer src="logic.js"></script>
  <script defer src="alpine.min.js"></script>
</head>

<body>
  <div x-data="{ login: '', 
                 user: '', 
                 loggedon: false, 
                 images: []
}" x-init="getLoginStatus($data);getImageList($data);" @paste.window="getImage($data, $event)">
    <header>
      <h1><a href="/">Trifecta</a> - admin</h1>

      <template x-if="loggedon">
        <div>
          <span>Logged in as </span><span x-text="user"></span>
          <button @click="doLogout($data)">Logout</button>
        </div>
      </template>

      <template x-if="!loggedon">
        <div>
          <form x-cloak @submit.prevent="doLogin($el, $data)">
            <label for="user">Username:</label>
            <input type="text" id="user" name="user" required>

            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>

            <button type="submit">Login</button>
          </form>
        </div>
      </template>
    </header>


    <div id="imagelist">
      <h2>All images</h2>
      <table>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>IP</th>
          <th>Type</th>
          <th>Size</th>
          <th>Public</th>
          <th>Thumbnail</th>
        </tr>
        <template x-for="g in images">
          <tr>
            <td x-text="g.id"></td>
            <td x-text="g.user"></td>
            <td x-text="g.ip"></td>
            <td x-text="g.type"></td>
            <td x-text="g.size"></td>
            <td><input type="checkbox" x-bind:checked="g.public" /></td>
            <td><a x-bind:href="'index.html?i='+g.id"><img loading="lazy" class="thumb" x-bind:src="'i/'+g.id"></a></td>
          </tr>
        </template>
      </table>
      <button @click="getImageList($data)">Refresh</button>
    </div>
  </div>
</body>

</html>